# S-Equal: Student-only 等预算基线实验
# 20 epochs, adaptive_unet, 无KD

# === 基础训练配置 ===
epochs: 30
batch_size: 6
lr: 0.0005
img_size: 384
num_workers: 4
num_classes: 3

# === 数据/划分（Video-aware）---
split_strategy: "video_aware"  # 使用video-aware分割策略
val_ratio: 0.2  # video_aware 模式推荐比例

# === 分类配置 ===
classification_scheme: "3class_org"

# === 知识蒸馏配置 ===
enable_distillation: false  # 关键：无KD
student_model: "adaptive_unet"  # Student模型

# --- 优化与调度 ---
optimizer: "adamw"
weight_decay: 0.001
scheduler: "cosine"

# --- FOV/预处理 ---
apply_fov_mask: true

# --- 增强 ---
augment: true
flip_prob: 0.5
rotation_degree: 15

# --- 监控/保存/早停 ---
save_best_only: true
val_interval: 1
save_interval: 5
early_stopping: true
patience: 10
loss_threshold: 0.015  # Loss改善阈值（hybrid evaluation）
loss_degradation_threshold: 0.05  # Loss恶化阈值

# --- 早停策略配置 ---
early_stopping_metric: "miou"  # 早停判定指标: loss(最小化) 或 miou(最大化)

# --- 高级损失函数配置 ---
loss_type: "combined"  # CE+Dice 组合损失（与KD对齐）
dice_weight: 0.4  # Dice损失权重（与KD对齐）
use_focal_loss: false  # 是否在combined中使用Focal作为基础损失
focal_alpha: 1.0  # Focal Loss alpha参数
focal_gamma: 2.0  # Focal Loss gamma参数
label_smoothing: 0.0  # 标签平滑参数（S-Equal不使用KD的0.05）
auto_class_weights: true  # 自动计算类别权重（与KD对齐）
class_weight_sample_ratio: 0.15  # 权重计算采样比例（与KD对齐）

# --- 可视化/证据包 ---
save_viz: true
viz_samples: 12
generate_evidence_package: true
evidence_experiment_name: "S_Equal"

experiment_regime: "S-Equal-VideoAware"
experiment_notes: "Equal-budget baseline with video-aware split, 30 epochs"